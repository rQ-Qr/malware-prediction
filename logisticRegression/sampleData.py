import pandas as pd
import sys


import pandas as pd
import sys

def sample_data(path, num_rows, output_filename):
    total_rows = sum(1 for row in open(path, 'r'))
    skip_interval = round(total_rows / num_rows)

    df = pd.read_csv(path, header=0, skiprows=lambda i: i % skip_interval != 0 and i != 0)

    column_label = df.columns[27]
    print("Dropping column 28 with label: ", column_label)
    df = df.drop(column_label, axis=1)

    df.to_csv(output_filename, index=False)

def main():
    if len(sys.argv) != 2:
        num_rows = 1000  # default number of rows to sample
    else:
        num_rows = int(sys.argv[1])

    path = '../Source/train.csv'
    filename = 'sample.csv'

    sample_data(path, num_rows, filename)

if __name__ == "__main__":
    main()